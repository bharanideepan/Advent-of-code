let x = `?......../......../.............?..-................||.......|.-./....|.|/................|?...-.......??..-..
.../.........?................?.-.........?...?........................./?................-......?.........|.-
-?......................../...?........................?....-.....................................|...........
|.../......?......................?/..-...|.?..............-.............../....|..../........|............?..
......../..................-....................././...................?../....................-..............
......|.....?...........|.................?................................................./........?......-.
........?...............-..........................................................?...../.../.-....?...?/....
......|......|.././............/...........................-....................................?.............
.....-......|.................|......................../...../....?..............-.........................|/.
.....?-..|................-....|......?.................|..-..-......................./.....|........-........
......../......................|....|...............|.....-?./...??.....|...-......................-..-..|....
.................................................../....-.........-...?..............?.........?.....|.......?
/...|............./.?.................................-...?-..............|..........?................||..../.
......|...-.............................................../....../............./..?...........................
-....................................?.../.....................-.../.......?.................-................
....../......?-......|..-..............-.................?....../..?..|..?.............................../....
............../............../.........|.......?./..............|?...-|......../..../....-.........--..../..-.
..?............|..?.................?........|.?......................?../.....-.....//.......................
?.......|......./........-.......||........-..........||..|.............?.?..-......?......../................
...........?.............|...-...........|.?-?...................|...................?.......|................
.........../....?.........-/........?../../.................................?................|/...............
/.....?..?....-.............................|.|..............-....|....-........../........./.................
..|...../....../.....?................./........../.....|.....................-../......./...-.............-..
..-.../............./...-...|.../........|.................---...........-..-......?.......-..................
......./......|..........-........?...........?..-./..........................................?.?.............
................/......................../.|.....?........|.-..|...|.........-.|..-......................?....
.........................-..........||...............-..-...................?..../.............|....?.|.......
.?..........................-....-...-.....................................|............?/............-.|..?/.
...-...............-.........................-..?||.............?..../....../............?.-.....?............
??......../............................/..........|........................................-....-...|.........
......?|.........?.....-/|................|....-.?......|-.?.........................|...................../..
.?..........-..........................?........../.|.................|/..........|..|.....?....-........../..
/..|.|.|............................/...|..............|.................../...../.??/...............-..-.....
..?.............|........................................-.................././...........-....?..............
..............................-......../.........../....|.............?.......|.....|.............-...........
....?|.............../................................?.|...../-.............?/.-..../..........-.............
.........|...............?................?........-...?..?............/......./......-............|..|.../...
..../.....-..../...-...?...............|..................|...................................-........?......
.............-...........-...........?....../.....?/......../..........?.................//.-.................
.....................-.|....|...-..........?...........-....-...-......|..............?.|./...................
.../?..|..........?...................|........../..............|?.............?..............|?-........?....
....................-............|............./.|/....-....?....-..................?./...?...?...............
.......................|...|./..............?.?......//...---....?........../..?..?..?..............?|........
....../..................../................../....................../.........|...|............-?............
.|...............-....?../-/............../......?.....-.........................../.../..-.................|.
....../...........?....../.../../......../.......|.........?........-../..-................../............../.
.?...............|.......|............|..........-....|.....?.....-......../.-.........?.-............/.....-.
..................-.......|..................-...?......../|...|....-............../.................././.-...
..............|......?.|/...-.........||.....?....|........-....-........-................../.....-.......?...
..................................-.....|...............................|......../......-........?..?../...|-.
.-..............?....|...................|....|.|........?-............/.../........../.|..................../
............|..............-............?...|..............................................?.||..-.....-......
...................|...........|......./.|..........................................?......-.../.......|.-....
..|..-............-..............?.............|.........?..../..................|............|........-...-|.
.............?......../............................||..-.|............?..........??.../.../.|..//............/
..............................?../....-..../..|...?.................|?..|........./.................../.......
....................?...............?......?..|..-...........................?........?.../......-....-.......
.......-....................................?..-.............?...?.?.......?............||?./...............-.
.....|..?..........|......?........-...............?..........?..?......../..........?..../.?|.-....-.........
.................?...-........?...|......................./.....?......./......../.....?.-...........-........
............?..-....?.-......-...?../?.-...................|......................?..............-......../...
../......./.....?-.?.................../......?....?...../..-.....?............./...........................|?
.................?../.?..-......................??....-...............-./-.|...|..|.|../....?..?......-...-...
........|..............|..........?-...../................//.....................................-............
|-....|......../-.?.||............|..........??.........../....................................../-......./...
-............................../............|?...././..................-.|..........-....-..|......?....|.....
......?.-..../.............?..-............................................-.....?...|...|........|..|........
.....--..|........||.-...///.....................................?......|.................?......../.-..?.....
......?....|.................../../..|/.............|........................-...........|.....?..............
./....-./..|..................?......?.?........./?|........................................./.......-...../..
.....|.......|-............./.|.............-........-................/........................-..|.?.........
../............|......|...........-..........?....|........................../..|............................/
..../...........|...............?.........|...|....|.............?...............-..|.....|.-.-.........?.|...
.............|..|....|...........................?.........||/-..-.?............?.......?../..............|...
.../?......|....//.....................-.../....................../............./|............................
.....-.-......|............?........-.........?.../.?............./....|.....?...-..|......./......?.....?/./.
......?/................../.............../....|.........-................-...|..../........-......./......|..
..-.|...................|...............................?.....................................................
.........?.....-?|.-|.........../..........................................?............./................/...
......|........?..|................?.........../....?........?.................?......?..............?........
?|................/......../.....?..........-..|.......-..............|...-............-................/?...?
?....|.........|........?....?......?...-....../..................?..............?......-.....................
......?.......?....................-......../.|.................|..........?..................|....-|.....|?..
.../.....................?......?.........?.............|.-.........?........?......................?.........
........|......-..../............??......-..........|...|/..............................|?....|.........?.....
....|........../............/.|..../....................................-.-...............-....-..............
............/......................................|...?..|.......................|.............../...........
......././/......-............................../.........?.-...-........../................/...-........-|...
./....-.|.........|..||.................................?............../.................../.............-....
...-/......./?....../?...|......-...........-...-.....-.-.|........................./................./.......
.........../.....................................?.........|.?............./.......................-.....|../.
..../..-........../.?.........|........................................./......./...............?.............
.....?............./............-..../-...?.?..../....................................../.............-.......
......./........-......-........../.|/.............../.....................-?..............................?..
......../....................-..............-..|.........?..................../........../....|.?.?...........
.........................../.|......................-..............-..............?.......?...................
.-............./|.........?......-.............../.../......?......../....?.............-...?.?.-.....-.......
-............./..--....??...?..-.|..........-.?-.?./.................||....-.....|.-.../....?.................
.........-|-......-........................-.....?...............-.../.......................-|..|..../.......
.....|....??........./.?.....|.-.?|........-..../.........../...............?...|.../|......|.................
....-................?...................../.?.?..|....-.|..........................?.....-...|.....?.........
.................................?...........................?.........../.-?............|......-..........?..
/......|............................|....................|...............-..............|.-......./....../....
|...|.........-..-...-.................|................../...|.......................?.......|./.............
...../.....|.....|............................/......-..........?.............?.//............................
..................-.-.?..........-...?..|......-................./...-.....................-..-..?...........?
..................?./-................?....|........................................-|........................
.................?...-.................-........./.......................-..........-................?........
.|../../................/.....|.............|.........................-..............?/..........|...........|
...........-.....?............./.......|.............|...../?-....-...../...?...?..............-|......?.?/.?.`;
const input = x.split("\n").map((line) => line.split(""));
let count = 0;
let paths = new Set();
let visited = new Set();
let lastMove = { x: 0, y: 1 };
const findNext = ({ x, y }, { x: dx, y: dy }) => {
  let key = `${x},${y}:${dx},${dy}`;
  let coordinate = `${x},${y}`;
  let row = input[x];
  if (!row) return;
  let currentValue = row[y];
  if (!currentValue) return;
  if (visited.has(key)) return;
  visited.add(key);
  if (!paths.has(coordinate)) count++;
  paths.add(coordinate);
  const moveRight = () => findNext({ x, y: y + 1 }, { x: 0, y: 1 });
  const moveLeft = () => findNext({ x, y: y - 1 }, { x: 0, y: -1 });
  const moveDown = () => findNext({ x: x + 1, y }, { x: 1, y: 0 });
  const moveUp = () => findNext({ x: x - 1, y }, { x: -1, y: 0 });
  const fromLeft = dx === 0 && dy === 1;
  const fromRight = dx === 0 && dy === -1;
  const fromTop = dx === 1 && dy === 0;
  const fromBottom = dx === -1 && dy === 0;
  if (currentValue === ".") {
    if (fromLeft) moveRight();
    if (fromRight) moveLeft();
    if (fromTop) moveDown();
    if (fromBottom) moveUp();
  }
  if (currentValue === "|") {
    if (fromLeft || fromRight) {
      moveUp();
      moveDown();
    }
    if (fromTop) moveDown();
    if (fromBottom) moveUp();
  }
  if (currentValue === "-") {
    if (fromLeft) moveRight();
    if (fromRight) moveLeft();
    if (fromTop || fromBottom) {
      moveRight();
      moveLeft();
    }
  }
  if (currentValue === "/") {
    if (fromLeft) moveUp();
    if (fromRight) moveDown();
    if (fromTop) moveLeft();
    if (fromBottom) moveRight();
  }
  if (currentValue === "?") {
    if (fromLeft) moveDown();
    if (fromRight) moveUp();
    if (fromTop) moveRight();
    if (fromBottom) moveLeft();
  }
};
findNext({ x: 0, y: 0 }, lastMove);
console.log(count);
